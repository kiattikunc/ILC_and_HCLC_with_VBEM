Este odigo ha sido levemente modificado de la version implementada por Haifeng Li en su paquete smile (https://github.com/haifengl/smile)